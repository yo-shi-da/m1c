
<h1>グループ一覧</h1>

<table class="table table-hover">
  <thead>
    <tr class="table-success">
      <th>Name</th>
      <th>Owner</th>
      <th></th>
      <th>参加・未参加</th>
      <th colspan="10"></th>
    </tr>
  </thead>

  <tbody>
    <% @groups.each do |group| %>
      <tr>
        <td><%= group.name %></td>
        <td><%= group.users.first.name %></td>

        <% if current_user.id == group.owner_id %>
          <td><p>あなたは、Groupオーナーです。</p></td>
        <% else %>
            <% if @current_user_group != nil %>
              <% if group == @current_user_group %>
                <td><%= link_to '解除', member_path(id: @group_user.id), method: :delete, class:"btn btn-outline-success" %></td>
              <% else %>
                <td><p>他のグループに参加中</p></td>
              <% end %>
            <% else %>
              <td><%= link_to '参加する', members_path(group_id: group.id), method: :post, class:"btn btn-outline-success" %></td>
            <% end %>
        <% end %>

        <% if group.owner_id == current_user.id %>
          <td><%= link_to 'Edit', edit_group_path(group), class:"btn btn-outline-success" %></td>
          <td><%= link_to 'Destroy', group, class:"btn btn-outline-danger", method: :delete, data: { confirm: 'グループメンバー全員消えますよ?' } %></td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%# カレントユーザーが、グループに所属していない場合のみ表示 %>
<% unless my_group.present? %>
  <%= link_to 'グループ作成', new_group_path, class:"btn btn-outline-info" %>
<% end %>
